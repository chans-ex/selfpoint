
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ìè¨Ïù∏Ìä∏ Í¥ÄÎ¶¨</title>
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
</head>
<body style="margin:0; background:#e5e7eb; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">
  <div id="root"></div>
  <script type="text/babel">
    const { useState, useMemo, Fragment } = React;

    const TEST_IDS = [
      'TMPDScb32d04b64d94a9', 'TMPDS4abdb524d673492', 'TMPDS5254acb93dbe46c',
      'TMPDSa2686c826a28485', 'TMPDS6a4757e6a3c34cc', 'TMPDSc53c81cb026f488',
      'TMPDS067d9b743d17463', 'TMPDS43098c59653c486', 'TMPDS21c02640426e436',
      'TMPDS8b09cd30f54e476', 'TMPDSd27bf78fb8e546a', 'TMPDSd5034a6fbad64be',
      'TMPDS77970861beae492', 'TMPDS28c045ff094843a', 'TMPDS4ccba6a2a15040e',
      'TMPDS731a0fb561354e0', 'TMPDS9fb6acec8fe14b8', 'TMPDSa9f21742c6e1b84',
      'TMPDSe5a4afa77d6346f', 'TMPDS1e7083124613423', 'TMPDSabb9d72cecd244d',
      'TMPDS4ecbd717abc5486', 'TMPDS87a0f273848f4d2', 'TMPDSc788cf5178fa428', 'dongatest',
    ];

    const maskName = (name) => {
      if (!name) return '-';
      if (name.length === 2) return name[0] + '*';
      if (name.length === 3) return name[0] + '*' + name[2];
      if (name.length > 3) return name[0] + '*'.repeat(name.length - 2) + name[name.length - 1];
      return name;
    };

    // ÏóÖÏ≤¥ Ïπ¥ÌÖåÍ≥†Î¶¨ Î∂ÑÎ•ò
    const getCompanyCategory = (company) => {
      if (!company || company === 'CS ÏàòÎèôÏ∞®Í∞ê') return 'etc';
      if (company === 'ÎèôÏïÑÏÇ¨Ïù¥Ïñ∏Ïä§Îß§Í±∞ÏßÑ' || company.startsWith('ÏÖÄÎüΩ_')) return 'subscription';
      if (company === 'dÎùºÏù¥Î∏åÎü¨Î¶¨' || company === 'ÎîîÎùºÏù¥Î∏åÎü¨Î¶¨') return 'digital';
      return 'store';
    };

    const getCategoryLabel = (category) => {
      if (category === 'subscription') return 'Ï†ïÍ∏∞Íµ¨ÎèÖ';
      if (category === 'digital') return 'ÎîîÏßÄÌÑ∏ÏΩòÌÖêÏ∏†';
      if (category === 'store') return 'ÏûÖÏ†êÏÇ¨';
      return '';
    };

    function App() {
      const [data, setData] = useState([]);
      const [fileName, setFileName] = useState('');
      const [mainTab, setMainTab] = useState('earn');
      const [useSubTab, setUseSubTab] = useState('company');
      const [searchTerm, setSearchTerm] = useState('');
      const [selectedMonth, setSelectedMonth] = useState('');
      const [showCanceled, setShowCanceled] = useState(false);
      const [expandedUser, setExpandedUser] = useState(null);
      const [expandedEarn, setExpandedEarn] = useState(null);
      const [showMismatchOnly, setShowMismatchOnly] = useState(false);

      const handleFileUpload = (e) => {
        const file = e.target.files[0];
        if (!file) return;
        setFileName(file.name);
        const reader = new FileReader();
        reader.onload = (event) => {
          try {
            const workbook = XLSX.read(event.target.result, { type: 'array' });
            const sheet = workbook.Sheets[workbook.SheetNames[0]];
            const jsonData = XLSX.utils.sheet_to_json(sheet);
            setData(jsonData);
            if (jsonData.length > 0) {
              const firstDate = jsonData[0]['Ï≤òÎ¶¨Ïùº'] || '';
              const match = firstDate.match(/(\d{4})\/(\d{2})/);
              if (match) setSelectedMonth(match[1] + '-' + match[2]);
            }
          } catch (err) { console.error(err); }
        };
        reader.readAsArrayBuffer(file);
      };

      const realData = useMemo(() => data.filter(item => !TEST_IDS.includes(item['Í≥†Í∞ùID'])), [data]);
      
      const canceledOrderNos = useMemo(() => {
        const nos = new Set();
        realData.forEach(r => {
          if (r['Ï£ºÎ¨∏ÏÉÅÌÉú'] === 'Ï∑®ÏÜåÏôÑÎ£å' && r['Ï£ºÎ¨∏Î≤àÌò∏']) {
            nos.add(String(r['Ï£ºÎ¨∏Î≤àÌò∏']));
          }
        });
        return nos;
      }, [realData]);
      
      const validData = useMemo(() => {
        if (showCanceled) return realData;
        return realData.filter(item => {
          const memo = item['Í¥ÄÎ¶¨ÏûêÎ©îÎ™®'] || '';
          if (item['Ï£ºÎ¨∏ÏÉÅÌÉú'] === 'Ï∑®ÏÜåÏôÑÎ£å') return false;
          if (item['ÌÉÄÏûÖ'] !== 'ÏÇ¨Ïö©') {
            if (memo.includes('Ï∑®ÏÜå Ìè¨Ïù∏Ìä∏') || memo.includes('Ï∑®ÏÜåÌè¨Ïù∏Ìä∏')) {
              const match = memo.match(/(\d{10})/);
              if (match && canceledOrderNos.has(match[1])) return false;
            }
          }
          return true;
        });
      }, [realData, showCanceled, canceledOrderNos]);
      
      const canceledCount = useMemo(() => realData.filter(item => item['Ï£ºÎ¨∏ÏÉÅÌÉú'] === 'Ï∑®ÏÜåÏôÑÎ£å').length, [realData]);
      const monthlyData = useMemo(() => !selectedMonth ? validData : validData.filter(row => (row['Ï≤òÎ¶¨Ïùº'] || '').startsWith(selectedMonth.replace('-', '/'))), [validData, selectedMonth]);
      const monthlyAllData = useMemo(() => !selectedMonth ? realData : realData.filter(row => (row['Ï≤òÎ¶¨Ïùº'] || '').startsWith(selectedMonth.replace('-', '/'))), [realData, selectedMonth]);
      
      const availableMonths = useMemo(() => { const m = new Set(); realData.forEach(r => { const d = r['Ï≤òÎ¶¨Ïùº'] || ''; const match = d.match(/(\d{4})\/(\d{2})/); if(match) m.add(match[1]+'-'+match[2]); }); return Array.from(m).sort().reverse(); }, [realData]);
      
      const earnData = useMemo(() => monthlyData.filter(r => r['ÌÉÄÏûÖ'] !== 'ÏÇ¨Ïö©'), [monthlyData]);
      const useData = useMemo(() => monthlyData.filter(r => r['ÌÉÄÏûÖ'] === 'ÏÇ¨Ïö©'), [monthlyData]);

      const carryoverPoint = useMemo(() => {
        if (!selectedMonth) return 0;
        const prevData = validData.filter(row => { const d = row['Ï≤òÎ¶¨Ïùº'] || ''; return d.substring(0,7).replace('/','-') < selectedMonth; });
        if (prevData.length === 0) return 0;
        const userLast = new Map();
        prevData.sort((a,b) => (a['Ï≤òÎ¶¨Ïùº']||'').localeCompare(b['Ï≤òÎ¶¨Ïùº']||'')).forEach(r => userLast.set(r['Í≥†Í∞ùID'], Number(r['ÌÜ†ÌÉàÌè¨Ïù∏Ìä∏'])||0));
        return Array.from(userLast.values()).reduce((s,v) => s+v, 0);
      }, [validData, selectedMonth]);

      const monthlyTotals = useMemo(() => {
        let used=0, earned=0;
        useData.forEach(r => { used += Number(r['Ìè¨Ïù∏Ìä∏'])||0; });
        earnData.forEach(r => { earned += Number(r['Ìè¨Ïù∏Ìä∏'])||0; });
        return { used, earned, carryover: carryoverPoint, balance: carryoverPoint + earned + used };
      }, [useData, earnData, carryoverPoint]);

      const expiringPoint = useMemo(() => {
        if (!selectedMonth) return 0;
        const [year, month] = selectedMonth.split('-');
        const lastDay = new Date(Number(year), Number(month), 0).getDate();
        const endOfMonth = `${year}/${month}/${lastDay}`;
        let total = 0;
        validData.forEach(row => {
          const expireDate = row['ÏÜåÎ©∏ ÏòàÏ†ïÏùº'] || '';
          const point = Number(row['Ìè¨Ïù∏Ìä∏']) || 0;
          if (expireDate && expireDate.substring(0,10) <= endOfMonth && point > 0) {
            total += point;
          }
        });
        return total;
      }, [validData, selectedMonth]);

      const earnByType = useMemo(() => {
        const map = new Map();
        earnData.forEach(row => {
          let memo = (row['Í¥ÄÎ¶¨ÏûêÎ©îÎ™®'] || '(Î©îÎ™®ÏóÜÏùå)').trim().replace(/\n/g, '');
          const point = Number(row['Ìè¨Ïù∏Ìä∏']) || 0;
          const userId = row['Í≥†Í∞ùID'];
          const date = (row['Ï≤òÎ¶¨Ïùº'] || '').substring(0, 10);
          const isCancelRefund = memo.includes('Ï∑®ÏÜå Ìè¨Ïù∏Ìä∏') || memo.includes('Ï∑®ÏÜåÌè¨Ïù∏Ìä∏');
          if (!map.has(memo)) map.set(memo, { memo, totalPoint: 0, users: new Set(), dates: new Map(), isCancelRefund });
          const item = map.get(memo);
          item.totalPoint += point;
          item.users.add(userId);
          if (!item.dates.has(date)) item.dates.set(date, { point: 0, count: 0 });
          item.dates.get(date).point += point;
          item.dates.get(date).count += 1;
        });
        return Array.from(map.values()).map(item => ({
          memo: item.memo, totalPoint: item.totalPoint, userCount: item.users.size, isCancelRefund: item.isCancelRefund,
          dateList: Array.from(item.dates.entries()).sort((a,b) => a[0].localeCompare(b[0])).map(([date, data]) => ({ date, point: data.point, count: data.count }))
        })).sort((a,b) => b.totalPoint - a.totalPoint);
      }, [earnData]);

      const companyStats = useMemo(() => {
        const map = new Map();
        useData.forEach(row => {
          const company = row['ÏóÖÏ≤¥Î™Ö'] || 'CS ÏàòÎèôÏ∞®Í∞ê';
          const point = Math.abs(Number(row['Ìè¨Ïù∏Ìä∏']) || 0);
          const userId = row['Í≥†Í∞ùID'];
          if (!map.has(company)) map.set(company, { company, usedPoint: 0, users: new Set(), category: getCompanyCategory(company) });
          map.get(company).usedPoint += point;
          map.get(company).users.add(userId);
        });
        return Array.from(map.values()).map(item => ({ company: item.company, usedPoint: item.usedPoint, userCount: item.users.size, category: item.category })).sort((a,b) => b.usedPoint - a.usedPoint);
      }, [useData]);

      const productStats = useMemo(() => {
        const map = new Map();
        useData.forEach(row => {
          const productCode = row['ÏÉÅÌíàÏΩîÎìú'] || '-';
          const company = row['ÏóÖÏ≤¥Î™Ö'] || 'CS ÏàòÎèôÏ∞®Í∞ê';
          const productName = row['ÏÉÅÌíàÎ™Ö'] || '-';
          const key = productCode + '|' + company;
          const point = Math.abs(Number(row['Ìè¨Ïù∏Ìä∏']) || 0);
          const userId = row['Í≥†Í∞ùID'];
          if (!map.has(key)) map.set(key, { productCode, company, productName, usedPoint: 0, users: new Set() });
          map.get(key).usedPoint += point;
          map.get(key).users.add(userId);
        });
        return Array.from(map.values()).map(item => ({ productCode: item.productCode, company: item.company, productName: item.productName, usedPoint: item.usedPoint, userCount: item.users.size })).sort((a,b) => b.usedPoint - a.usedPoint);
      }, [useData]);

      const userStats = useMemo(() => {
        const map = new Map();
        monthlyAllData.forEach(row => {
          const id = row['Í≥†Í∞ùID'];
          const name = row['Í≥†Í∞ùÎ™Ö'];
          const type = row['ÌÉÄÏûÖ'];
          const point = Number(row['Ìè¨Ïù∏Ìä∏']) || 0;
          const date = row['Ï≤òÎ¶¨Ïùº'] || '';
          const memo = row['Í¥ÄÎ¶¨ÏûêÎ©îÎ™®'] || '';
          const orderNo = row['Ï£ºÎ¨∏Î≤àÌò∏'] || '';
          const status = row['Ï£ºÎ¨∏ÏÉÅÌÉú'] || '';
          const total = Number(row['ÌÜ†ÌÉàÌè¨Ïù∏Ìä∏']) || 0;
          if (!map.has(id)) map.set(id, { id, name, earnedPoint: 0, usedPoint: 0, transactions: [], currentPoint: 0 });
          const user = map.get(id);
          if (type === 'ÏÇ¨Ïö©') user.usedPoint += point;
          else user.earnedPoint += point;
          user.transactions.push({ date, type, point, memo, orderNo, status, total });
          user.currentPoint = total;
        });
        
        const prevData = validData.filter(row => { const d = row['Ï≤òÎ¶¨Ïùº'] || ''; return d.substring(0,7).replace('/','-') < selectedMonth; });
        const userStartPoints = new Map();
        if (prevData.length > 0) {
          prevData.sort((a,b) => (a['Ï≤òÎ¶¨Ïùº']||'').localeCompare(b['Ï≤òÎ¶¨Ïùº']||'')).forEach(r => userStartPoints.set(r['Í≥†Í∞ùID'], Number(r['ÌÜ†ÌÉàÌè¨Ïù∏Ìä∏'])||0));
        }

        return Array.from(map.values()).map(user => {
          const startPoint = userStartPoints.get(user.id) || 0;
          const calculatedPoint = startPoint + user.earnedPoint + user.usedPoint;
          const mismatch = Math.abs(calculatedPoint - user.currentPoint) > 1;
          return { ...user, startPoint, calculatedPoint, mismatch };
        }).sort((a,b) => b.usedPoint - a.usedPoint);
      }, [monthlyAllData, validData, selectedMonth]);

      const filteredCompanyStats = useMemo(() => {
        if (!searchTerm) return companyStats;
        return companyStats.filter(c => c.company.toLowerCase().includes(searchTerm.toLowerCase()));
      }, [companyStats, searchTerm]);

      const filteredProductStats = useMemo(() => {
        if (!searchTerm) return productStats;
        const term = searchTerm.toLowerCase();
        return productStats.filter(p => p.productCode.toLowerCase().includes(term) || p.company.toLowerCase().includes(term) || p.productName.toLowerCase().includes(term));
      }, [productStats, searchTerm]);

      const filteredUserStats = useMemo(() => {
        let result = userStats;
        if (showMismatchOnly) result = result.filter(u => u.mismatch);
        if (!searchTerm) return result;
        const term = searchTerm.toLowerCase();
        return result.filter(u => u.id.toLowerCase().includes(term) || u.name.toLowerCase().includes(term));
      }, [userStats, searchTerm, showMismatchOnly]);

      const mismatchCount = useMemo(() => userStats.filter(u => u.mismatch).length, [userStats]);

      const categoryTotals = useMemo(() => {
        const totals = { subscription: 0, digital: 0, store: 0, etc: 0 };
        companyStats.forEach(c => totals[c.category] += c.usedPoint);
        return totals;
      }, [companyStats]);

      const handleDownload = () => {
        let exportData = [];
        if (useSubTab === 'company') exportData = filteredCompanyStats.map(c => ({ Íµ¨Î∂Ñ: getCategoryLabel(c.category), ÏóÖÏ≤¥Î™Ö: c.company, ÏÇ¨Ïö©Ìè¨Ïù∏Ìä∏: c.usedPoint, Ïù∏Ïõê: c.userCount }));
        else if (useSubTab === 'product') exportData = filteredProductStats.map(p => ({ ÏÉÅÌíàÏΩîÎìú: p.productCode, ÏûÖÏ†êÏÇ¨: p.company, ÏÉÅÌíàÎ™Ö: p.productName, ÏÇ¨Ïö©Ìè¨Ïù∏Ìä∏: p.usedPoint, Ïù∏Ïõê: p.userCount }));
        else if (useSubTab === 'user') exportData = filteredUserStats.map(u => ({ ÏïÑÏù¥Îîî: u.id, Ïù¥Î¶Ñ: u.name, ÏãúÏûë: u.startPoint, Ï†ÅÎ¶Ω: u.earnedPoint, ÏÇ¨Ïö©: u.usedPoint, ÏûîÏó¨: u.currentPoint, Í≤ÄÏ¶ù: u.mismatch ? 'Î∂àÏùºÏπò' : 'Ï†ïÏÉÅ' }));
        const ws = XLSX.utils.json_to_sheet(exportData);
        const wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, 'Sheet1');
        XLSX.writeFile(wb, `Ìè¨Ïù∏Ìä∏_${useSubTab}_${new Date().toISOString().slice(0,10)}.xlsx`);
      };

      const colors = {
        primary: '#1e40af',
        success: '#059669',
        danger: '#dc2626',
        warning: '#f59e0b',
        muted: '#6b7280',
        border: '#d1d5db',
        light: '#f3f4f6',
        dark: '#1f2937'
      };

      const tooltips = {
        carryover: 'Ï†ÑÏõîÏù¥Ïõî: ÏßÄÎÇúÎã¨ ÏûîÏó¨ÏôÄ ÎèôÏùºÌïú Í∏àÏï°ÏûÖÎãàÎã§. ÏßÄÎÇúÎã¨ Îßê Í∏∞Ï§Ä Í∞Å ÏÇ¨Ïö©ÏûêÏùò ÎßàÏßÄÎßâ ÌÜ†ÌÉàÌè¨Ïù∏Ìä∏ Ìï©Í≥ÑÏûÖÎãàÎã§.',
        earned: 'Ï†ÅÎ¶Ω: Ïù¥Î≤à Îã¨Ïóê ÏÉàÎ°ú Ï†ÅÎ¶ΩÎêú Ìè¨Ïù∏Ìä∏ Ï¥ùÏï°ÏûÖÎãàÎã§. (Ïù¥Î≤§Ìä∏, Íµ¨ÎèÖ ÌòúÌÉù Îì±)',
        used: 'ÏÇ¨Ïö©: Ïù¥Î≤à Îã¨Ïóê ÏÉÅÌíà Íµ¨Îß§ Îì±ÏúºÎ°ú ÏÇ¨Ïö©Îêú Ìè¨Ïù∏Ìä∏ Ï¥ùÏï°ÏûÖÎãàÎã§. (ÎßàÏù¥ÎÑàÏä§ Í∏àÏï°)',
        balance: 'ÏûîÏó¨: Ï†ÑÏõîÏù¥Ïõî + Ï†ÅÎ¶Ω + ÏÇ¨Ïö©ÏúºÎ°ú Í≥ÑÏÇ∞Îê©ÎãàÎã§. Ïù¥Î≤à Îã¨ Îßê Í∏∞Ï§Ä ÏòàÏÉÅ ÏûîÏó¨ Ìè¨Ïù∏Ìä∏ÏûÖÎãàÎã§.',
        expiring: 'ÏÜåÎ©∏ÏòàÏ†ï: Ïù¥Î≤à Îã¨ ÎßêÍπåÏßÄ ÏÜåÎ©∏ ÏòàÏ†ïÏù∏ Ìè¨Ïù∏Ìä∏ÏûÖÎãàÎã§. Îã§Ïùå Îã¨ÏóêÎäî Ïù¥ Í∏àÏï°Ïù¥ ÏÇ¨ÎùºÏßëÎãàÎã§.'
      };

      const cardStyle = { 
        flex: 1, 
        padding: '16px 20px', 
        backgroundColor: 'white', 
        borderRadius: '8px', 
        borderLeft: '4px solid', 
        boxShadow: '0 1px 3px rgba(0,0,0,0.1)',
        minWidth: '180px'
      };

      const btnStyle = {
        padding: '8px 16px',
        border: 'none',
        borderRadius: '6px',
        cursor: 'pointer',
        fontSize: '13px',
        fontWeight: '500',
        transition: 'all 0.2s',
        backgroundColor: '#1e40af',
        color: 'white'
      };

      const inputStyle = {
        padding: '8px 12px',
        border: '1px solid ' + colors.border,
        borderRadius: '6px',
        fontSize: '13px',
        outline: 'none',
        transition: 'border-color 0.2s'
      };

      const tabStyle = (isActive) => ({
        padding: '10px 20px',
        border: 'none',
        background: isActive ? '#1e40af' : 'transparent',
        color: isActive ? 'white' : colors.muted,
        cursor: 'pointer',
        fontSize: '14px',
        fontWeight: '500',
        borderRadius: '6px 6px 0 0',
        transition: 'all 0.2s'
      });

      const subTabStyle = (tab) => ({
        padding: '12px 24px',
        border: 'none',
        background: useSubTab === tab ? 'white' : 'transparent',
        color: useSubTab === tab ? colors.dark : colors.muted,
        cursor: 'pointer',
        fontSize: '14px',
        fontWeight: useSubTab === tab ? '600' : '400',
        borderBottom: useSubTab === tab ? '3px solid #1e40af' : '3px solid transparent',
        transition: 'all 0.2s'
      });

      const thStyle = {
        padding: '12px 16px',
        backgroundColor: '#f9fafb',
        borderBottom: '2px solid ' + colors.border,
        textAlign: 'left',
        fontSize: '12px',
        fontWeight: '600',
        color: colors.dark,
        textTransform: 'uppercase',
        letterSpacing: '0.05em'
      };

      const tdStyle = {
        padding: '12px 16px',
        borderBottom: '1px solid #f3f4f6',
        fontSize: '13px',
        color: '#374151'
      };

      return (
        <div style={{ minHeight: '100vh', display: 'flex', flexDirection: 'column' }}>
          {/* Header */}
          <div style={{ 
            backgroundColor: '#1e293b', 
            color: 'white', 
            padding: '16px 32px',
            boxShadow: '0 2px 4px rgba(0,0,0,0.1)',
            display: 'flex',
            justifyContent: 'space-between',
            alignItems: 'center'
          }}>
            <h1 style={{ margin: 0, fontSize: '20px', fontWeight: '600' }}>Ìè¨Ïù∏Ìä∏ Í¥ÄÎ¶¨ ÏãúÏä§ÌÖú</h1>
            <div style={{ display: 'flex', alignItems: 'center', gap: '16px' }}>
              {fileName && (
                <span style={{ fontSize: '13px', color: '#94a3b8' }}>üìÑ {fileName}</span>
              )}
              <label style={{ ...btnStyle, cursor: 'pointer', display: 'inline-block' }}>
                ÌååÏùº ÏóÖÎ°úÎìú
                <input type="file" accept=".xlsx,.xls" onChange={handleFileUpload} style={{ display: 'none' }} />
              </label>
            </div>
          </div>

          {/* Main Content */}
          <div style={{ flex: 1, padding: '24px 32px', maxWidth: '1600px', width: '100%', margin: '0 auto' }}>
            {data.length > 0 && (
              <Fragment>
                {/* Filters */}
                <div style={{ 
                  backgroundColor: 'white', 
                  borderRadius: '8px', 
                  padding: '16px 20px', 
                  marginBottom: '20px',
                  boxShadow: '0 1px 3px rgba(0,0,0,0.1)',
                  display: 'flex',
                  gap: '12px',
                  alignItems: 'center',
                  flexWrap: 'wrap'
                }}>
                  <select value={selectedMonth} onChange={(e) => setSelectedMonth(e.target.value)} style={{ ...inputStyle, minWidth: '150px' }}>
                    <option value="">Ï†ÑÏ≤¥ Í∏∞Í∞Ñ</option>
                    {availableMonths.map(m => <option key={m} value={m}>{m}</option>)}
                  </select>
                  <label style={{ display: 'flex', alignItems: 'center', gap: '6px', fontSize: '13px', cursor: 'pointer', color: colors.muted }}>
                    <input type="checkbox" checked={showCanceled} onChange={(e) => setShowCanceled(e.target.checked)} />
                    Ï∑®ÏÜåÏôÑÎ£å Ìè¨Ìï®
                    {canceledCount > 0 && <span style={{ color: colors.warning }}>({canceledCount}Í±¥)</span>}
                  </label>
                  <div style={{ fontSize: '13px', color: colors.muted, marginLeft: 'auto' }}>
                    Ï¥ù {realData.length.toLocaleString()}Í±¥
                  </div>
                </div>

                {/* Stats Cards */}
                <div style={{ display: 'flex', gap: '16px', marginBottom: '24px', flexWrap: 'wrap' }}>
                  <div style={{ ...cardStyle, borderLeftColor: colors.muted }}>
                    <div style={{ fontSize: '12px', color: colors.muted, marginBottom: '4px', fontWeight: '500' }}>Ï†ÑÏõîÏù¥Ïõî</div>
                    <div style={{ fontSize: '24px', fontWeight: '700', color: '#374151', marginBottom: '8px' }}>{monthlyTotals.carryover.toLocaleString()}</div>
                    <div style={{ fontSize: '10px', color: colors.muted, lineHeight: '1.4', opacity: 0.8 }}>{tooltips.carryover}</div>
                  </div>

                  <div style={{ ...cardStyle, borderLeftColor: colors.success }}>
                    <div style={{ fontSize: '12px', color: colors.muted, marginBottom: '4px', fontWeight: '500' }}>Ï†ÅÎ¶Ω ({earnData.length})</div>
                    <div style={{ fontSize: '24px', fontWeight: '700', color: colors.success, marginBottom: '8px' }}>+{monthlyTotals.earned.toLocaleString()}</div>
                    <div style={{ fontSize: '10px', color: colors.muted, lineHeight: '1.4', opacity: 0.8 }}>{tooltips.earned}</div>
                  </div>

                  <div style={{ ...cardStyle, borderLeftColor: colors.danger }}>
                    <div style={{ fontSize: '12px', color: colors.muted, marginBottom: '4px', fontWeight: '500' }}>ÏÇ¨Ïö© ({useData.length})</div>
                    <div style={{ fontSize: '24px', fontWeight: '700', color: colors.danger, marginBottom: '8px' }}>{monthlyTotals.used.toLocaleString()}</div>
                    <div style={{ fontSize: '10px', color: colors.muted, lineHeight: '1.4', opacity: 0.8 }}>{tooltips.used}</div>
                  </div>

                  <div style={{ ...cardStyle, borderLeftColor: colors.primary, backgroundColor: '#eff6ff' }}>
                    <div style={{ fontSize: '12px', color: colors.muted, marginBottom: '4px', fontWeight: '500' }}>ÏûîÏó¨</div>
                    <div style={{ fontSize: '24px', fontWeight: '700', color: colors.primary, marginBottom: '8px' }}>{monthlyTotals.balance.toLocaleString()}</div>
                    <div style={{ fontSize: '10px', color: colors.muted, lineHeight: '1.4', opacity: 0.8 }}>{tooltips.balance}</div>
                  </div>

                  <div style={{ ...cardStyle, borderLeftColor: colors.warning, backgroundColor: '#fffbeb' }}>
                    <div style={{ fontSize: '12px', color: colors.warning, marginBottom: '4px', fontWeight: '500' }}>ÏÜåÎ©∏ÏòàÏ†ï</div>
                    <div style={{ fontSize: '24px', fontWeight: '700', color: colors.warning, marginBottom: '8px' }}>{expiringPoint.toLocaleString()}</div>
                    <div style={{ fontSize: '10px', color: colors.muted, lineHeight: '1.4', opacity: 0.8 }}>{tooltips.expiring}</div>
                  </div>
                </div>

                {/* Tabs */}
                <div style={{ display: 'flex', gap: '4px', marginBottom: '16px' }}>
                  <button style={tabStyle(mainTab === 'earn')} onClick={() => setMainTab('earn')}>
                    Ï†ÅÎ¶Ω ÎÇ¥Ïó≠
                  </button>
                  <button style={tabStyle(mainTab === 'use')} onClick={() => setMainTab('use')}>
                    ÏÇ¨Ïö© ÎÇ¥Ïó≠
                  </button>
                </div>

                {/* Content */}
                {mainTab === 'earn' && (
                  <div style={{ backgroundColor: 'white', borderRadius: '8px', boxShadow: '0 1px 3px rgba(0,0,0,0.1)', overflow: 'hidden' }}>
                    <div style={{ padding: '12px 16px', backgroundColor: '#f9fafb', borderBottom: '1px solid ' + colors.border, fontSize: '13px', color: colors.muted, fontWeight: '500' }}>
                      {earnByType.length}Í∞ú Ï†ÅÎ¶Ω Ïú†Ìòï
                    </div>
                    <div style={{ maxHeight: 'calc(100vh - 480px)', overflowY: 'auto' }}>
                      <table style={{ width: '100%', borderCollapse: 'collapse' }}>
                        <thead style={{ position: 'sticky', top: 0, zIndex: 1 }}>
                          <tr>
                            <th style={{ ...thStyle, width: '30px' }}></th>
                            <th style={thStyle}>Ï†ÅÎ¶Ω Ïú†Ìòï</th>
                            <th style={{ ...thStyle, textAlign: 'right', width: '140px' }}>Ìè¨Ïù∏Ìä∏</th>
                            <th style={{ ...thStyle, textAlign: 'right', width: '80px' }}>Ïù∏Ïõê</th>
                          </tr>
                        </thead>
                        <tbody>
                          {earnByType.map((e, i) => (
                            <Fragment key={i}>
                              <tr style={{ cursor: 'pointer', backgroundColor: expandedEarn === i ? '#f9fafb' : 'transparent' }} onClick={() => setExpandedEarn(expandedEarn === i ? null : i)}>
                                <td style={tdStyle}>{expandedEarn === i ? '‚ñº' : '‚ñ∂'}</td>
                                <td style={{ ...tdStyle, fontStyle: e.isCancelRefund ? 'italic' : 'normal', color: e.isCancelRefund ? colors.muted : '#374151' }}>{e.memo}</td>
                                <td style={{ ...tdStyle, textAlign: 'right', color: e.isCancelRefund ? colors.warning : colors.success, fontWeight: '600', fontSize: '14px' }}>+{e.totalPoint.toLocaleString()}</td>
                                <td style={{ ...tdStyle, textAlign: 'right', color: colors.muted }}>{e.userCount}</td>
                              </tr>
                              {expandedEarn === i && (
                                <tr>
                                  <td colSpan={4} style={{ padding: '0', backgroundColor: '#f9fafb' }}>
                                    <div style={{ padding: '16px 20px' }}>
                                      <table style={{ width: '100%', fontSize: '12px' }}>
                                        <thead>
                                          <tr>
                                            <th style={{ padding: '8px 12px', textAlign: 'left', borderBottom: '1px solid ' + colors.border, fontSize: '11px', color: colors.muted }}>ÏùºÏûê</th>
                                            <th style={{ padding: '8px 12px', textAlign: 'right', borderBottom: '1px solid ' + colors.border, fontSize: '11px', color: colors.muted }}>Ìè¨Ïù∏Ìä∏</th>
                                            <th style={{ padding: '8px 12px', textAlign: 'right', borderBottom: '1px solid ' + colors.border, fontSize: '11px', color: colors.muted }}>Í±¥Ïàò</th>
                                          </tr>
                                        </thead>
                                        <tbody>
                                          {e.dateList.map((d, j) => (
                                            <tr key={j}>
                                              <td style={{ padding: '8px 12px' }}>{d.date}</td>
                                              <td style={{ padding: '8px 12px', textAlign: 'right', color: colors.success, fontWeight: '500' }}>+{d.point.toLocaleString()}</td>
                                              <td style={{ padding: '8px 12px', textAlign: 'right' }}>{d.count}</td>
                                            </tr>
                                          ))}
                                        </tbody>
                                      </table>
                                    </div>
                                  </td>
                                </tr>
                              )}
                            </Fragment>
                          ))}
                        </tbody>
                      </table>
                    </div>
                  </div>
                )}

                {mainTab === 'use' && (
                  <div style={{ backgroundColor: 'white', borderRadius: '8px', boxShadow: '0 1px 3px rgba(0,0,0,0.1)', overflow: 'hidden' }}>
                    <div style={{ display: 'flex', borderBottom: '2px solid #f3f4f6' }}>
                      <button style={subTabStyle('company')} onClick={() => { setUseSubTab('company'); setSearchTerm(''); }}>ÏóÖÏ≤¥Î≥Ñ</button>
                      <button style={subTabStyle('product')} onClick={() => { setUseSubTab('product'); setSearchTerm(''); }}>ÏÉÅÌíàÎ≥Ñ</button>
                      <button style={subTabStyle('user')} onClick={() => { setUseSubTab('user'); setSearchTerm(''); }}>
                        ÏÇ¨Ïö©ÏûêÎ≥Ñ {mismatchCount > 0 && <span style={{ color: colors.danger, marginLeft: '4px', fontSize: '12px' }}>({mismatchCount})</span>}
                      </button>
                    </div>
                    <div style={{ padding: '12px 16px', display: 'flex', gap: '10px', borderBottom: '1px solid ' + colors.border, alignItems: 'center', backgroundColor: '#f9fafb' }}>
                      <input type="text" placeholder={useSubTab === 'company' ? 'ÏóÖÏ≤¥Î™Ö Í≤ÄÏÉâ...' : useSubTab === 'product' ? 'ÏÉÅÌíàÏΩîÎìú/ÏûÖÏ†êÏÇ¨/ÏÉÅÌíàÎ™Ö Í≤ÄÏÉâ...' : 'Ïù¥Î¶Ñ/ID Í≤ÄÏÉâ...'} value={searchTerm} onChange={(e) => setSearchTerm(e.target.value)} style={{ ...inputStyle, flex: 1 }} />
                      {useSubTab === 'user' && mismatchCount > 0 && (
                        <label style={{ display: 'flex', alignItems: 'center', gap: '6px', fontSize: '13px', cursor: 'pointer', whiteSpace: 'nowrap', color: colors.muted }}>
                          <input type="checkbox" checked={showMismatchOnly} onChange={(e) => setShowMismatchOnly(e.target.checked)} />
                          Î∂àÏùºÏπòÎßå
                        </label>
                      )}
                      <button onClick={handleDownload} style={{ ...btnStyle, backgroundColor: colors.primary }}>ÏóëÏÖÄ Îã§Ïö¥Î°úÎìú</button>
                    </div>

                    {useSubTab === 'company' && (
                      <Fragment>
                        <div style={{ padding: '12px 16px', backgroundColor: '#f9fafb', borderBottom: '1px solid ' + colors.border, fontSize: '12px', color: colors.muted }}>
                          <div style={{ display: 'flex', gap: '20px', flexWrap: 'wrap', fontWeight: '500' }}>
                            <span>{filteredCompanyStats.length}Í∞ú ÏóÖÏ≤¥</span>
                            <span style={{ color: '#7c3aed' }}>‚óè Ï†ïÍ∏∞Íµ¨ÎèÖ: {categoryTotals.subscription.toLocaleString()}</span>
                            <span style={{ color: '#0891b2' }}>‚óè ÎîîÏßÄÌÑ∏ÏΩòÌÖêÏ∏†: {categoryTotals.digital.toLocaleString()}</span>
                            <span style={{ color: colors.danger }}>‚óè ÏûÖÏ†êÏÇ¨: {categoryTotals.store.toLocaleString()}</span>
                          </div>
                        </div>
                        <div style={{ maxHeight: 'calc(100vh - 450px)', overflowY: 'auto' }}>
                          <table style={{ width: '100%', borderCollapse: 'collapse' }}>
                            <thead style={{ position: 'sticky', top: 0, zIndex: 1 }}>
                              <tr>
                                <th style={{ ...thStyle, width: '100px' }}>Íµ¨Î∂Ñ</th>
                                <th style={thStyle}>ÏóÖÏ≤¥Î™Ö</th>
                                <th style={{ ...thStyle, textAlign: 'right', width: '140px' }}>ÏÇ¨Ïö©Ìè¨Ïù∏Ìä∏</th>
                                <th style={{ ...thStyle, textAlign: 'right', width: '80px' }}>Ïù∏Ïõê</th>
                              </tr>
                            </thead>
                            <tbody>
                              {filteredCompanyStats.map((c, i) => (
                                <tr key={i} style={{ backgroundColor: i % 2 === 0 ? 'white' : '#fafafa' }}>
                                  <td style={{ ...tdStyle, fontSize: '11px' }}>
                                    {c.category === 'subscription' && <span style={{ padding: '3px 8px', borderRadius: '4px', backgroundColor: '#f3e8ff', color: '#7c3aed', fontWeight: '500' }}>Ï†ïÍ∏∞Íµ¨ÎèÖ</span>}
                                    {c.category === 'digital' && <span style={{ padding: '3px 8px', borderRadius: '4px', backgroundColor: '#e0f2fe', color: '#0891b2', fontWeight: '500' }}>ÎîîÏßÄÌÑ∏</span>}
                                    {c.category === 'store' && <span style={{ padding: '3px 8px', borderRadius: '4px', backgroundColor: '#fef2f2', color: colors.danger, fontWeight: '500' }}>ÏûÖÏ†êÏÇ¨</span>}
                                    {c.category === 'etc' && <span style={{ padding: '3px 8px', borderRadius: '4px', backgroundColor: '#f1f5f9', color: colors.muted, fontWeight: '500' }}>Í∏∞ÌÉÄ</span>}
                                  </td>
                                  <td style={{ ...tdStyle, color: c.company === 'CS ÏàòÎèôÏ∞®Í∞ê' ? colors.muted : '#374151', fontStyle: c.company === 'CS ÏàòÎèôÏ∞®Í∞ê' ? 'italic' : 'normal', fontWeight: '500' }}>{c.company}</td>
                                  <td style={{ ...tdStyle, textAlign: 'right', color: colors.danger, fontWeight: '600', fontSize: '14px' }}>{c.usedPoint.toLocaleString()}</td>
                                  <td style={{ ...tdStyle, textAlign: 'right', color: colors.muted }}>{c.userCount}</td>
                                </tr>
                              ))}
                            </tbody>
                          </table>
                        </div>
                      </Fragment>
                    )}

                    {useSubTab === 'product' && (
                      <Fragment>
                        <div style={{ padding: '12px 16px', backgroundColor: '#f9fafb', borderBottom: '1px solid ' + colors.border, fontSize: '12px', color: colors.muted, fontWeight: '500' }}>
                          {filteredProductStats.length}Í∞ú ÏÉÅÌíà
                        </div>
                        <div style={{ maxHeight: 'calc(100vh - 410px)', overflowY: 'auto' }}>
                          <table style={{ width: '100%', borderCollapse: 'collapse' }}>
                            <thead style={{ position: 'sticky', top: 0, zIndex: 1 }}>
                              <tr>
                                <th style={{ ...thStyle, width: '110px' }}>ÏÉÅÌíàÏΩîÎìú</th>
                                <th style={{ ...thStyle, width: '130px' }}>ÏûÖÏ†êÏÇ¨</th>
                                <th style={thStyle}>ÏÉÅÌíàÎ™Ö</th>
                                <th style={{ ...thStyle, textAlign: 'right', width: '130px' }}>ÏÇ¨Ïö©Ìè¨Ïù∏Ìä∏</th>
                                <th style={{ ...thStyle, textAlign: 'right', width: '70px' }}>Ïù∏Ïõê</th>
                              </tr>
                            </thead>
                            <tbody>
                              {filteredProductStats.map((p, i) => (
                                <tr key={i} style={{ backgroundColor: i % 2 === 0 ? 'white' : '#fafafa' }}>
                                  <td style={{ ...tdStyle, fontFamily: 'monospace', fontSize: '11px', color: colors.muted }}>{p.productCode}</td>
                                  <td style={{ ...tdStyle, fontSize: '12px', color: p.company === 'CS ÏàòÎèôÏ∞®Í∞ê' ? colors.muted : '#374151', fontStyle: p.company === 'CS ÏàòÎèôÏ∞®Í∞ê' ? 'italic' : 'normal' }}>{p.company}</td>
                                  <td style={{ ...tdStyle, maxWidth: '350px', overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap' }} title={p.productName}>{p.productName}</td>
                                  <td style={{ ...tdStyle, textAlign: 'right', color: colors.danger, fontWeight: '600', fontSize: '14px' }}>{p.usedPoint.toLocaleString()}</td>
                                  <td style={{ ...tdStyle, textAlign: 'right', color: colors.muted }}>{p.userCount}</td>
                                </tr>
                              ))}
                            </tbody>
                          </table>
                        </div>
                      </Fragment>
                    )}

                    {useSubTab === 'user' && (
                      <Fragment>
                        <div style={{ padding: '12px 16px', backgroundColor: '#f9fafb', borderBottom: '1px solid ' + colors.border, fontSize: '12px', color: colors.muted, display: 'flex', justifyContent: 'space-between', fontWeight: '500' }}>
                          <span>{filteredUserStats.length}Î™Ö</span>
                          {mismatchCount > 0 && !showMismatchOnly && (
                            <span style={{ color: colors.danger }}>Î∂àÏùºÏπò {mismatchCount}Î™Ö</span>
                          )}
                        </div>
                        <div style={{ maxHeight: 'calc(100vh - 410px)', overflowY: 'auto' }}>
                          <table style={{ width: '100%', borderCollapse: 'collapse' }}>
                            <thead style={{ position: 'sticky', top: 0, zIndex: 1 }}>
                              <tr>
                                <th style={{ ...thStyle, width: '35px' }}></th>
                                <th style={thStyle}>ÏïÑÏù¥Îîî</th>
                                <th style={thStyle}>Ïù¥Î¶Ñ</th>
                                <th style={{ ...thStyle, textAlign: 'right', width: '90px' }}>ÏãúÏûë</th>
                                <th style={{ ...thStyle, textAlign: 'right', width: '90px' }}>Ï†ÅÎ¶Ω</th>
                                <th style={{ ...thStyle, textAlign: 'right', width: '90px' }}>ÏÇ¨Ïö©</th>
                                <th style={{ ...thStyle, textAlign: 'right', width: '90px' }}>ÏûîÏó¨</th>
                                <th style={{ ...thStyle, textAlign: 'center', width: '60px' }}>Í≤ÄÏ¶ù</th>
                              </tr>
                            </thead>
                            <tbody>
                              {filteredUserStats.map((u, i) => (
                                <Fragment key={i}>
                                  <tr style={{ cursor: 'pointer', backgroundColor: u.mismatch ? '#fef2f2' : (expandedUser === i ? '#f9fafb' : (i % 2 === 0 ? 'white' : '#fafafa')) }} onClick={() => setExpandedUser(expandedUser === i ? null : i)}>
                                    <td style={tdStyle}>{expandedUser === i ? '‚ñº' : '‚ñ∂'}</td>
                                    <td style={{ ...tdStyle, fontFamily: 'monospace', fontSize: '11px', color: colors.muted }}>{u.id}</td>
                                    <td style={{ ...tdStyle, fontWeight: '600' }}>{maskName(u.name)}</td>
                                    <td style={{ ...tdStyle, textAlign: 'right', color: colors.muted }}>{u.startPoint.toLocaleString()}</td>
                                    <td style={{ ...tdStyle, textAlign: 'right', color: colors.success, fontWeight: '500' }}>+{u.earnedPoint.toLocaleString()}</td>
                                    <td style={{ ...tdStyle, textAlign: 'right', color: colors.danger, fontWeight: '600' }}>{u.usedPoint.toLocaleString()}</td>
                                    <td style={{ ...tdStyle, textAlign: 'right', fontWeight: '700', color: colors.primary, fontSize: '14px' }}>{u.currentPoint.toLocaleString()}</td>
                                    <td style={{ ...tdStyle, textAlign: 'center' }}>
                                      {u.mismatch ? <span style={{ color: colors.danger, fontSize: '16px', fontWeight: 'bold' }}>‚úó</span> : <span style={{ color: colors.success, fontSize: '16px', fontWeight: 'bold' }}>‚úì</span>}
                                    </td>
                                  </tr>
                                  {expandedUser === i && (
                                    <tr>
                                      <td colSpan={8} style={{ padding: '0', backgroundColor: '#f9fafb' }}>
                                        <div style={{ padding: '16px 20px' }}>
                                          <div style={{ fontSize: '11px', color: colors.muted, marginBottom: '12px', padding: '8px 12px', backgroundColor: 'white', borderRadius: '6px', display: 'inline-block', border: '1px solid ' + colors.border }}>
                                            <strong>Í≥ÑÏÇ∞Ïãù:</strong> {u.startPoint.toLocaleString()} + {u.earnedPoint.toLocaleString()} + ({u.usedPoint.toLocaleString()}) = {u.calculatedPoint.toLocaleString()}
                                            {u.mismatch && <span style={{ color: colors.danger, marginLeft: '12px', fontWeight: 'bold' }}>‚â† Ïã§Ï†ú {u.currentPoint.toLocaleString()}</span>}
                                          </div>
                                          <table style={{ width: '100%', fontSize: '12px', backgroundColor: 'white', borderRadius: '6px', overflow: 'hidden' }}>
                                            <thead>
                                              <tr style={{ backgroundColor: '#f3f4f6' }}>
                                                <th style={{ padding: '10px 12px', textAlign: 'left', borderBottom: '1px solid ' + colors.border, fontSize: '11px', fontWeight: '600', color: colors.dark }}>ÏùºÏãú</th>
                                                <th style={{ padding: '10px 12px', textAlign: 'left', borderBottom: '1px solid ' + colors.border, fontSize: '11px', fontWeight: '600', color: colors.dark }}>ÌÉÄÏûÖ</th>
                                                <th style={{ padding: '10px 12px', textAlign: 'left', borderBottom: '1px solid ' + colors.border, fontSize: '11px', fontWeight: '600', color: colors.dark }}>Ï£ºÎ¨∏Î≤àÌò∏</th>
                                                <th style={{ padding: '10px 12px', textAlign: 'right', borderBottom: '1px solid ' + colors.border, fontSize: '11px', fontWeight: '600', color: colors.dark }}>Ìè¨Ïù∏Ìä∏</th>
                                                <th style={{ padding: '10px 12px', textAlign: 'right', borderBottom: '1px solid ' + colors.border, fontSize: '11px', fontWeight: '600', color: colors.dark }}>ÏûîÏï°</th>
                                                <th style={{ padding: '10px 12px', textAlign: 'left', borderBottom: '1px solid ' + colors.border, fontSize: '11px', fontWeight: '600', color: colors.dark }}>Î©îÎ™®</th>
                                              </tr>
                                            </thead>
                                            <tbody>
                                              {[...u.transactions].sort((a, b) => a.date.localeCompare(b.date)).map((tx, j) => (
                                                <tr key={j} style={{ backgroundColor: tx.status === 'Ï∑®ÏÜåÏôÑÎ£å' ? '#fef2f2' : 'transparent' }}>
                                                  <td style={{ padding: '10px 12px', borderBottom: '1px solid #f3f4f6' }}>{tx.date}</td>
                                                  <td style={{ padding: '10px 12px', borderBottom: '1px solid #f3f4f6' }}>
                                                    <span style={{ padding: '3px 8px', borderRadius: '4px', fontSize: '10px', fontWeight: '500', backgroundColor: tx.type === 'ÏÇ¨Ïö©' ? '#fef2f2' : '#f0fdf4', color: tx.type === 'ÏÇ¨Ïö©' ? colors.danger : colors.success }}>{tx.type}</span>
                                                    {tx.status === 'Ï∑®ÏÜåÏôÑÎ£å' && <span style={{ marginLeft: '6px', fontSize: '10px', color: colors.muted }}>(Ï∑®ÏÜå)</span>}
                                                  </td>
                                                  <td style={{ padding: '10px 12px', fontFamily: 'monospace', fontSize: '11px', color: colors.muted, borderBottom: '1px solid #f3f4f6' }}>{tx.orderNo || '-'}</td>
                                                  <td style={{ padding: '10px 12px', textAlign: 'right', color: tx.point < 0 ? colors.danger : colors.success, fontWeight: '600', borderBottom: '1px solid #f3f4f6' }}>{tx.point > 0 ? '+' : ''}{tx.point.toLocaleString()}</td>
                                                  <td style={{ padding: '10px 12px', textAlign: 'right', fontWeight: '500', borderBottom: '1px solid #f3f4f6' }}>{tx.total.toLocaleString()}</td>
                                                  <td style={{ padding: '10px 12px', maxWidth: '250px', overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap', color: colors.muted, borderBottom: '1px solid #f3f4f6' }} title={tx.memo}>{tx.memo || '-'}</td>
                                                </tr>
                                              ))}
                                            </tbody>
                                          </table>
                                        </div>
                                      </td>
                                    </tr>
                                  )}
                                </Fragment>
                              ))}
                            </tbody>
                          </table>
                        </div>
                      </Fragment>
                    )}
                  </div>
                )}
              </Fragment>
            )}

            {data.length === 0 && (
              <div style={{ 
                backgroundColor: 'white', 
                borderRadius: '8px', 
                padding: '80px 40px', 
                textAlign: 'center', 
                boxShadow: '0 1px 3px rgba(0,0,0,0.1)' 
              }}>
                <div style={{ fontSize: '48px', marginBottom: '16px', opacity: 0.3 }}>üìä</div>
                <p style={{ color: colors.muted, margin: 0, fontSize: '15px' }}>ÏóëÏÖÄ ÌååÏùºÏùÑ ÏóÖÎ°úÎìúÌïòÏó¨ Ìè¨Ïù∏Ìä∏ ÎÇ¥Ïó≠ÏùÑ Î∂ÑÏÑùÌïòÏÑ∏Ïöî</p>
              </div>
            )}
          </div>
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>
</html>

